# Week of 2024-08-19 to 2024-08-26 (32)

### GHFirst (6)

- [Revert "[dynamo][super] Improve handling of getattr on super (#134039)"](https://github.com/pytorch/pytorch/commit/7fd3b6988681557a4dfc35dc99807cdd78e805c9)
  - broke internal torchrec signals, see [D61670727](https://www.internalfb.com/diff/D61670727) ([comment](https://github.com/pytorch/pytorch/pull/134039#issuecomment-2307151643))
- [Revert "[inductor] Fix needs_fixed_stride_order silent incorrectness (#133639)"](https://github.com/pytorch/pytorch/commit/09127b096c7cdf54429e2f12eb6a625a1eb22d45)
  - Broke internal fbgemm signals, see [D61670495](https://www.internalfb.com/diff/D61670495) ([comment](https://github.com/pytorch/pytorch/pull/133639#issuecomment-2307133060))
- [Revert "Update FlexAttention with masking semantic (#133373)"](https://github.com/pytorch/pytorch/commit/1a7e8e5780be3bd30c32a295087785d069eef05d)
  - Broke internal test/inductor signals, see D61611729 ([comment](https://github.com/pytorch/pytorch/pull/133373#issuecomment-2304714503))
- [Revert "[FlexAttention] Enable different qk and v head-dims (#134043)"](https://github.com/pytorch/pytorch/commit/88c973005d283300cab55d0c13826154328fd2a1)
  - Need to revert, in order to be able to revert https://github.com/pytorch/pytorch/pull/133373, feel free to reland this after solving conflicts ([comment](https://github.com/pytorch/pytorch/pull/134043#issuecomment-2304708996))
- [Revert "[SymmetricMemory] introduce multicast support, multimem_all_reduce_ and multimem_one_shot_all_reduce (#133424)"](https://github.com/pytorch/pytorch/commit/cedfac20c7c9f3049091d708160bc6cfd7124be4)
  - Broke internal ADS builds, see D61611517 ([comment](https://github.com/pytorch/pytorch/pull/133424#issuecomment-2304676328))
- [Revert "[dtensor] move DTensor to public namespace (#133113)"](https://github.com/pytorch/pytorch/commit/35f36363ec288c780fd86b3d55147a468c63166e)
  - looks like it break some internal type imports ([comment](https://github.com/pytorch/pytorch/pull/133113#issuecomment-2295670911))

### Ignored Signal (2)

- [Revert "[report_exportability] Avoid re-exporting duplicated modules (#133930)"](https://github.com/pytorch/pytorch/commit/49f6ea6dd91c7d069cf6103eb00b1b849f1bdc03)
  - breaks lint ([comment](https://github.com/pytorch/pytorch/pull/133930#issuecomment-2299513046))
- [Revert "Add MaskedTensor support to *_like API (#128637)"](https://github.com/pytorch/pytorch/commit/68570fca69649296489df4300f3a4f8f36683e08)
  - Introduced API linting errors ([comment](https://github.com/pytorch/pytorch/pull/128637#issuecomment-2298270307))

### Landrace (1)

- [Revert "[hop] ban creating hop by directly instantiating HigherOrderOperator. (#133645)"](https://github.com/pytorch/pytorch/commit/1491a61769855cb445f5f732be437ef89c023394)
  - breaking ci. probably due to land race ([comment](https://github.com/pytorch/pytorch/pull/133645#issuecomment-2302866106))

### Not through pytorchbot (2)

- [Back out "[1/N] Fix clang-tidy warnings in inductor (#131979)" (#133922)](https://github.com/pytorch/pytorch/commit/81a822ddc9aa6cf970bf279bb2b3184146278da4)
- [Back out "[export] fix test for training ir migration" (#133697)](https://github.com/pytorch/pytorch/commit/f1dc3b108a1ef81a07704228a6be0353f37121fe)

### No Signal (10)

- [Revert "[ROCm] remove triton-rocm commit pin and merge pins with triton.txt (#133438)"](https://github.com/pytorch/pytorch/commit/4648848696de7a7577892aaf0149b7bd96d07d8d)
  - seems to have introduced breakages in linux binary builds ([comment](https://github.com/pytorch/pytorch/pull/133438#issuecomment-2308787310))
- [Revert "[dtensor][MTPG] make sharding prop lru cache not shared among threads (#134294)"](https://github.com/pytorch/pytorch/commit/e5563f7ad7f456fe8b440300b308e2bd97357d78)
  - seems to have introduced https://github.com/pytorch/pytorch/actions/runs/10537099590/job/29201744658 ([comment](https://github.com/pytorch/pytorch/pull/134294#issuecomment-2308785949))
- [Revert "[dynamo][fix] always use POSIX-style path in `trace_rule.py` (#133987)"](https://github.com/pytorch/pytorch/commit/75c22dd8bf8801a6eaf9bbe30e08cf8c05ded6a1)
  - This breaks windows trunk jobs ([comment](https://github.com/pytorch/pytorch/pull/133987#issuecomment-2306956764))
- [Revert "[ONNX] Opt into ruff fmt (#134120)"](https://github.com/pytorch/pytorch/commit/b0171c39209acadec0ff07f584a176ea1bbd5039)
  - Breaks main branch lint ([comment](https://github.com/pytorch/pytorch/pull/134120#issuecomment-2305089756))
- [Revert "[BE]: Update Typeguard to TypeIs for better type inference (#133814)"](https://github.com/pytorch/pytorch/commit/2db28a96113de4bf8fa6ba3bfa85698b557f3855)
  - root cause of internal failures not addressed ([comment](https://github.com/pytorch/pytorch/pull/133814#issuecomment-2302466444))
- [Revert "[dynamo][reland][inline-inbuilt-nn-modules] Mark attributes of nn modâ€¦ (#133714)"](https://github.com/pytorch/pytorch/commit/68425e68fed2efbce58f999d6530fd76ebfa9673)
  - fails internally ([comment](https://github.com/pytorch/pytorch/pull/133714#issuecomment-2302171472))
- [Revert "[BE]: Update Typeguard to TypeIs for better type inference (#133814)"](https://github.com/pytorch/pytorch/commit/42097f0ec16f69385aa96605e0bb8778faf22ab1)
  - Broke 12k internal signals/jobs, @ezyang please help get those changes merged. More details check D61488368 ([comment](https://github.com/pytorch/pytorch/pull/133814#issuecomment-2298210309))
- [Revert "[ONNX] New export logic leveraging ExportedProgram and ONNX IR (#132530)"](https://github.com/pytorch/pytorch/commit/8d404581fccae251a6b8c09744f9643f38ad94c9)
  - Sorry but it seems like Dr. CI incorrectly flagged the [pull / linux-docs / build-docs-python-false](https://hud.pytorch.org/pr/pytorch/pytorch/132530#28918577682) failure as being flaky. The job started failing consistently on CI once your PR was merged. [GH job link](https://github.com/pytorch/pytorch/actions/runs/10454830880/job/28949386844) [HUD commit link](https://hud.pytorch.org/pytorch/pytorch/commit/5fab35d77c7d1db7dbb9d5c516254a510b4f4f64) ([comment](https://github.com/pytorch/pytorch/pull/132530#issuecomment-2297001423))
- [Revert "[inductor][cpp] complete vectorization for int32/int64 (#122961)"](https://github.com/pytorch/pytorch/commit/76b0284744b73de25b11bd4e631bcf1c4794a746)
  - Breaks slow jobs: inductor/test_cpu_repro.py::CPUReproTests::test__adaptive_avg_pool2d [GH job link](https://github.com/pytorch/pytorch/actions/runs/10432403692/job/28893704833) [HUD commit link](https://hud.pytorch.org/pytorch/pytorch/commit/a0ef8888e60d934ae7e4ddaec1c1274b12d0d39d) ([comment](https://github.com/pytorch/pytorch/pull/122961#issuecomment-2296852418))
- [Revert "[Inductor][CPP] Support vectorization of load_seed and randn (#130317)"](https://github.com/pytorch/pytorch/commit/318d3b39c4e101257186366cbf8b6094283cdaef)
  - Breaks slow jobs: inductor/test_cpu_repro.py::CPUReproTests::test__adaptive_avg_pool2d [GH job link](https://github.com/pytorch/pytorch/actions/runs/10432403692/job/28893704833) [HUD commit link](https://hud.pytorch.org/pytorch/pytorch/commit/a0ef8888e60d934ae7e4ddaec1c1274b12d0d39d) ([comment](https://github.com/pytorch/pytorch/pull/130317#issuecomment-2296819045))

### Weird (11)

- [Revert "[RFC][dynamo] add decorator to register polyfill for unsupported C++ function to avoid graph break (#133712)"](https://github.com/pytorch/pytorch/commit/15b5a0b67fc3f34fb0bf1afa6f91e0c4c2b7fd8d)
  - breaking main windows cpu tests - this stack still causes that windows test to fail ([comment](https://github.com/pytorch/pytorch/pull/133712#issuecomment-2299776241))
- [Revert "[dynamo] simplify polyfill registration for `builtins.all` and `builtins.any` (#133769)"](https://github.com/pytorch/pytorch/commit/88ead0afc69c57359b02294e638228fe79a9b0d5)
  - breaking main windows cpu tests - this stack still causes that windows test to fail ([comment](https://github.com/pytorch/pytorch/pull/133712#issuecomment-2299776241))
- [Revert "[dynamo] simplify implementation for `functools.reduce` (#133778)"](https://github.com/pytorch/pytorch/commit/3fa874abbefcba5bf1ca075783230796d8896061)
  - breaking main windows cpu tests - this stack still causes that windows test to fail ([comment](https://github.com/pytorch/pytorch/pull/133712#issuecomment-2299776241))
- [Revert "[dynamo] simplify implementation for `builtins.sum` (#133779)"](https://github.com/pytorch/pytorch/commit/98e6a1d8ff100690b0efdb14b17e91f5d25081a7)
  - breaking main windows cpu tests - this stack still causes that windows test to fail ([comment](https://github.com/pytorch/pytorch/pull/133712#issuecomment-2299776241))
- [Revert "[dynamo][itertools] support `itertools.tee` (#133771)"](https://github.com/pytorch/pytorch/commit/2540ee372a7f731c9a4e1a22d4ba2881dfa57af6)
  - breaking main windows cpu tests - this stack still causes that windows test to fail ([comment](https://github.com/pytorch/pytorch/pull/133712#issuecomment-2299776241))
- [Revert "return state dict without optimized module (#132626)"](https://github.com/pytorch/pytorch/commit/3a2f7192c3bcd2151a3e78b0bb758e12cfc75581)
  - Sorry but it seems like this PR broke trunk. distributed/checkpoint/test_state_dict.py::TestStateDict::test_fsdp2 [GH job link](https://github.com/pytorch/pytorch/actions/runs/10458281674/job/28969008325) [HUD commit link](https://hud.pytorch.org/pytorch/pytorch/commit/da69a28c6f73f1d876550aa768050bc92fec83d4).  Probably bad TD ([comment](https://github.com/pytorch/pytorch/pull/132626#issuecomment-2299190664))
- [Revert "[RFC][dynamo] add decorator to register polyfill for unsupported C++ function to avoid graph break (#133712)"](https://github.com/pytorch/pytorch/commit/2bd02e0c82c6d76157244655256062bade5070ae)
  - breaking main windows cpu tests - reverting them all, so we can identify the culprit with more calmness ([comment](https://github.com/pytorch/pytorch/pull/133712#issuecomment-2298528797))
- [Revert "[dynamo] simplify polyfill registration for `builtins.all` and `builtins.any` (#133769)"](https://github.com/pytorch/pytorch/commit/91fd270535ca77702e154b6d8ff016d94b1473d4)
  - breaking main windows cpu tests - reverting them all, so we can identify the culprit with more calmness ([comment](https://github.com/pytorch/pytorch/pull/133712#issuecomment-2298528797))
- [Revert "[dynamo] simplify implementation for `functools.reduce` (#133778)"](https://github.com/pytorch/pytorch/commit/5109c5ef238d47db4723dfb80ccba8536b22b8bf)
  - breaking main windows cpu tests - reverting them all, so we can identify the culprit with more calmness ([comment](https://github.com/pytorch/pytorch/pull/133712#issuecomment-2298528797))
- [Revert "[dynamo] simplify implementation for `builtins.sum` (#133779)"](https://github.com/pytorch/pytorch/commit/08b5e07e6c5a8bbc87b0b03f128847e76f3a6325)
  - breaking main windows cpu tests ([comment](https://github.com/pytorch/pytorch/pull/133779#issuecomment-2298285206))
- [Revert "Update xpu CD used driver to rolling version (#133454)"](https://github.com/pytorch/pytorch/commit/f31404ba6f5a4aa2b7a5a962354552f487c70d49)
  - Sorry, there's [an outage](https://github.com/triton-lang/triton/issues/4527) that's preventing triton from being installed correctly, which has the side effect of breaking our docker builds. Reverting this PR since it requires a docker rebuild (which now fails) to give us more time to properly fix the docker builds. ([comment](https://github.com/pytorch/pytorch/pull/133454#issuecomment-2297073937))
