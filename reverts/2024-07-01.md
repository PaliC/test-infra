# Week of 2024-07-01 to 2024-07-08 (27)

### GHFirst (6)

- [Revert "[Inductor][CPP] Enable Local Buffer for Outer loop fusion (#126967)"](https://github.com/pytorch/pytorch/commit/e423224546adb2b2754ecb2287e14b45adb9734d)
  - Broken trunk and need rebase ([comment](https://github.com/pytorch/pytorch/pull/126967#issuecomment-2212337926))
- [Revert "[Inductor][CPP] Support more than one LocalBuffer (#129121)"](https://github.com/pytorch/pytorch/commit/1b57dce35fb42d84062d2f4ad3a61202efd771c6)
  - Broken trunk and need rebase ([comment](https://github.com/pytorch/pytorch/pull/129121#issuecomment-2212337590))
- [Revert "Change numeric_debug_handle to store per-node id (#129811)"](https://github.com/pytorch/pytorch/commit/784e3b412394298769b650f96edf0af8d25edb56)
  - breaking internal builds ([comment](https://github.com/pytorch/pytorch/pull/129811#issuecomment-2211245852))
- [Revert "XPUHooksInterface inherits from AcceleratorHooksInterface (#129463)"](https://github.com/pytorch/pytorch/commit/779fc8119e0915d128c3700b0fe669f8caf866d4)
  - breaking internal builds ([comment](https://github.com/pytorch/pytorch/pull/129463#issuecomment-2207529072))
- [Revert "Add xpu to getAccelerator (#129205)"](https://github.com/pytorch/pytorch/commit/8a9725bedbba4effff98998caf46f9064e59f2b4)
  - Need to revert https://github.com/pytorch/pytorch/pull/129463 which breaks Meta builds ([comment](https://github.com/pytorch/pytorch/pull/129205#issuecomment-2207514346))
- [Revert "[export] make with_effect mark op has_effect to prevent them from DCEed. (#129680)"](https://github.com/pytorch/pytorch/commit/89646ebb1196f26cda3d79c2592ef4e4eedff0f2)
  - breaking internal builds, see D59181183 ([comment](https://github.com/pytorch/pytorch/pull/129680#issuecomment-2204737227))

### Ignored Signal (2)

- [Revert "Fix the SDPA AOT export issue (#130164)"](https://github.com/pytorch/pytorch/commit/e019540c9eccd3c274f376752a9cea8895da8212)
  - Sorry for reverting your change but it is breaking ExecuTorch tests in trunk https://hud.pytorch.org/pytorch/pytorch/commit/1927c406844affbfe3496d5cbc31d4ebe11c8bfb ([comment](https://github.com/pytorch/pytorch/pull/130164#issuecomment-2211667777))
- [Revert "Change depreacate warning on dispatch_on_subclass to warn once (#130047)"](https://github.com/pytorch/pytorch/commit/6fc771d19b1e0dc6be678bd447dd5c280fb56382)
  - broke test_overrides.py::TestTorchFunctionWarning::test_warn_on_invalid_torch_function on multiple jobs https://hud.pytorch.org/pytorch/pytorch/commit/8ff243bcf190bab62348310693f0ad2f90061c89 https://github.com/pytorch/pytorch/actions/runs/9812489165/job/27097342443.  Dr CI is doing something weird about the unstable failures ([comment](https://github.com/pytorch/pytorch/pull/130047#issuecomment-2211409090))

### Landrace (1)

- [Revert "[runtime asserts] deduplicate runtime asserts & CSE (#128599)"](https://github.com/pytorch/pytorch/commit/963f430d13e29a43445e6e0aebc00ed7343c81d1)
  - Sorry for reverting your change but it seems to cause a landrace and fails inductor/test_cudagraph_trees in trunk https://hud.pytorch.org/pytorch/pytorch/commit/0267b2ddcb58aa66b2b62336216da7df4f9939d8 ([comment](https://github.com/pytorch/pytorch/pull/128599#issuecomment-2211690518))

### Not through pytorchbot (1)

- [Back out "Pass device to is_pinned call inside TensorProperties.create_from_tensor" (#129972)](https://github.com/pytorch/pytorch/commit/a1a2023eb86805b1a3867dbda9c89be3cd63dd27)

### No Signal (9)

- [Revert "[NCCL] Make sure current device is correct in `torch.distributed.barrier()`'s `streamSynchronize` (#129908)"](https://github.com/pytorch/pytorch/commit/4b05d9d2333fb97298a1db7492c6f02eccca674d)
  - Seems to have introduced windows errors on main ([comment](https://github.com/pytorch/pytorch/pull/129908#issuecomment-2210888890))
- [Revert "[pt2-bench] pass acc test if ref is NaN (#129996)"](https://github.com/pytorch/pytorch/commit/6dfa53ca7652ec5f11e9249dbf00d82bb51421b2)
  - Seems to have introduced breakages in main cuda12 focal jobs ([comment](https://github.com/pytorch/pytorch/pull/129996#issuecomment-2209175516))
- [Revert "[pt2-bench] fix accuracy failure for a few models (#129941)"](https://github.com/pytorch/pytorch/commit/fa3953a2e16b8dd4376d831bafde33c61e4093de)
  - Seems to have introduced breakages in main cuda12 focal jobs ([comment](https://github.com/pytorch/pytorch/pull/129996#issuecomment-2209175516))
- [Revert "[pt2-bench] fix accuracy failure for beit_base_patch16_224 during training (#130005)"](https://github.com/pytorch/pytorch/commit/54da35a2e02e2fe5bf014ca198ea69f19a38e833)
  - Seems to have introduced breakages in main cuda12 focal jobs ([comment](https://github.com/pytorch/pytorch/pull/129996#issuecomment-2209175516))
- [Revert "Add support for inline_asm_elementwise in Inductor lowerings (#129846)"](https://github.com/pytorch/pytorch/commit/03440a1c13caf5fdb060245483c0056a5b43627f)
  - introduced ROCm breakages in trunk ([comment](https://github.com/pytorch/pytorch/pull/129846#issuecomment-2203519554))
- [Revert "[MPS] Add support for autocast in MPS  (#99272)"](https://github.com/pytorch/pytorch/commit/07450e971348a03c5d4141bf56d1ca09abe5441c)
  - introduced breakages in trunk ([comment](https://github.com/pytorch/pytorch/pull/99272#issuecomment-2203033719))
- [Revert "[ROCm] std::clamp work-around for hip-clang compiler (#127812)"](https://github.com/pytorch/pytorch/commit/c2d0b7b96d38a07973e9ba98fbd111f8f66c97a0)
  - windows trunk job failing ([comment](https://github.com/pytorch/pytorch/pull/127812#issuecomment-2201653245))
- [Revert "Allow get attributes on DDP similar to FSDP (#128620)"](https://github.com/pytorch/pytorch/commit/b02186ffc1620b767e27bbf9fcd22a4216e544ce)
  - Reverting in order to see if the trunk error on inductor is fixed ([comment](https://github.com/pytorch/pytorch/pull/128620#issuecomment-2200717876))
- [Revert "[inductor] optimize cpp builder configuration code (#129577)"](https://github.com/pytorch/pytorch/commit/433b691f9823dc2e3404c90969df44ff5487a978)
  - Breaking internal builds, see D59181128 ([comment](https://github.com/pytorch/pytorch/pull/129577#issuecomment-2200554824))

### Weird (8)

- [Revert "[audio hash update] update the pinned audio hash (#129429)"](https://github.com/pytorch/pytorch/commit/eea4ece256d74c6f25c1f4eab37b3f2f4aeefd4d)
  - pytorch bot should not have allowed this merge, as there are failing jobs ([comment](https://github.com/pytorch/pytorch/pull/129429#issuecomment-2210894639))
- [Revert "[pipelining] [BE] Move pipeline_order validation to schedules.py (#129369)"](https://github.com/pytorch/pytorch/commit/b5fdbc1a9fb94e80f0addd836fee358d2446ea88)
  - broke test/distributed/pipelining/test_schedule.py::ScheduleTest::test_non_symmetric_stage_ids_ScheduleClass0 on distributed cuda https://github.com/pytorch/pytorch/actions/runs/9766039400/job/26959115773 https://hud.pytorch.org/pytorch/pytorch/commit/ec789a3c9ddd4e550b3dea6934ce2d41deb98784.  You can see the error on the PR, but Dr. CI classified it wrong ([comment](https://github.com/pytorch/pytorch/pull/129369#issuecomment-2204568418))
- [Revert "Fix typo in floordiv solver code that affects flipped relation (#129888)"](https://github.com/pytorch/pytorch/commit/c22e66896f8d83cede0bafd4da2e7beb9bde5d46)
  - Sorry for reverting your change but the updated test starts to fail flakily in trunk somehow, so I am reverting the change to see if it helps ([comment](https://github.com/pytorch/pytorch/pull/129888#issuecomment-2204442653))
- [Revert "Enable UFMT on test/test_public_bindings.py (#128389)"](https://github.com/pytorch/pytorch/commit/c9dc9887db0deff3ccbebf9b59dcbe79c3bd8a4f)
  - False alarm, the test is just flaky.  ~broke test_mps.py::TestMPS::test_mps_allocator_module? https://github.com/pytorch/pytorch/actions/runs/9730750763/job/26854426294 https://hud.pytorch.org/pytorch/pytorch/commit/fe5424d0f8604f6e66d827ae9f94b05cb7119d55 Not sure how this change can do that.  Build failed on PR so test didn't run~ ([comment](https://github.com/pytorch/pytorch/pull/128389#issuecomment-2200589719))
- [Revert "[inductor] split cpu vec isa to dedicate file (keep git history) (#129789)"](https://github.com/pytorch/pytorch/commit/19e17216a2c98ae954e634605c9cfdca6f6813a3)
  - Need to revert in order to revert https://github.com/pytorch/pytorch/pull/129577 ([comment](https://github.com/pytorch/pytorch/pull/129789#issuecomment-2200545144))
- [Revert "[inductor] unificate toolchain code. (#129816)"](https://github.com/pytorch/pytorch/commit/b6dc37bb4e8344b3e8099ccf759297129f9a332f)
  - Need to revert in order to revert #129577 ([comment](https://github.com/pytorch/pytorch/pull/129816#issuecomment-2200539687))
- [Revert "[halide-backend] Disable split reductions for Halide (#129320)"](https://github.com/pytorch/pytorch/commit/e385bf8ef8f84968c0ff6e47ca5e06d4948e8e62)
  - This PR is breaking internal builds, please check comments on it D59204360 ([comment](https://github.com/pytorch/pytorch/pull/129320#issuecomment-2200351678))
- [Revert "[halide-backend] Support manual schedules (#129321)"](https://github.com/pytorch/pytorch/commit/a83eaf1c3aa61b6ad37ad20fbb274e0396123495)
  - Reverting, as it is required to do so in order to revert #129320 ([comment](https://github.com/pytorch/pytorch/pull/129321#issuecomment-2200345664))
